# Cleaning up multiple version of modules that are not needed or I wanted to reset.
$Modules = @(
    'Az',
    'Az.Batch',
    'Az.Cdn',
    'Az.Compute',
    'Az.CosmosDB',
    'Az.Databricks',
    'Az.DataFactory',
    'Az.DataLakeStore',
    'Az.FrontDoor',
    'Az.FrontDoor',
    'Az.KeyVault',
    'Az.MachineLearningServices',
    'Az.Maintenance',
    'Az.Migrate',
    'Az.Migration',
    'Az.MySql',
    'Az.Network',
    'Az.Nginx',
    'Az.RedisCache'
    'Az.Sql',
    'Az.SqlVirtualMachine',
    'Az.StackHCI',
    'Az.StorageMover',
    'Az.StorageSync',
    'Az.Synapse',
    'ClipboardTools',
    'Curl2PS',
    'F7History',
    'Microsoft.Graph',
    'Microsoft.Graph.Beta.Applications',
    'Microsoft.Graph.Beta.DirectoryObjects',
    'Microsoft.Graph.Beta.Groups',
    'Microsoft.Graph.Beta.Groups',
    'Microsoft.Graph.Beta.Groups',
    'Microsoft.Graph.Beta.Identity.DirectoryManagement',
    'Microsoft.Graph.Beta.Identity.Governance',
    'Microsoft.Graph.Beta.Identity.Governance',
    'Microsoft.Graph.Beta.Identity.SignIns',
    'Microsoft.Graph.Beta.Reports',
    'Microsoft.Graph.Beta.Reports',
    'Microsoft.Graph.Beta.Users',
    'Microsoft.Graph.Beta.Users',
    'Microsoft.Graph.Beta.Users.Actions',
    'Microsoft.Graph.Beta.Users.Functions',
    'Microsoft.Graph.CrossDeviceExperiences',
    'Microsoft.Graph.DeviceManagement.Actions',
    'Microsoft.Graph.DeviceManagement.Administration',
    'Microsoft.Graph.DeviceManagement.Enrollment',
    'Microsoft.Graph.DeviceManagement.Functions',
    'Microsoft.Graph.Devices.CorporateManagement',
    'Microsoft.Graph.Devices.ServiceAnnouncement',
    'OdmApi',
    'PSAdvantage'
)
$Modules | ForEach-Object { Write-Output $_ ; Uninstall-Module $_ -Force -AllVersions -AllowPrerelease -ErrorAction SilentlyContinue }
Get-InstalledModule | Format-Table Version, Name
